#work
setwd("C://bb//")
library(RODBC)
air_conn = odbcConnect("airbnb")
#listings
listings<-as.data.frame(listings)
listings <- read.csv("C:/bb/airbnb/data/big/listings.csv", comment.char="#")
View(listings)
listings <- read.csv("C:/bb/airbnb/data/big/listings.csv", header=FALSE, comment.char="#")
View(listings)
listings.1 <- read.csv("C:/bb/airbnb/data/big/listings.1.csv")
View(listings.1)
summary(listings.1)
sqlSave(air_conn, listings)
sqlSave(air_conn, listings)
warnings()
listings.1 <- read.csv("C:/bb/airbnb/data/big/listings.1.csv")
View(listings.1)
summary(listings.1)
names(listings.1)
listings<-as.data.frame(listings.1)
sqlSave(air_conn, listings)
calendar <- read.csv("C:/bb/airbnb/data/big/calendar.csv")
View(calendar)
summary(calendar)
summary(calendar$date)
hist(calendar$date)
barplot(calendar$date)
calendar$date
table(calendar$date)
table(calendar$date)
calendar <- read.csv("C:/bb/airbnb/data/big/calendar.csv")
View(calendar)
calendars <- read.csv("C:/bb/airbnb/sf.calendars.cleaned.csv")
calendars
calendars <- read.csv("C:/bb/airbnb/sf.calendars.cleaned.csv", header = FALSE)
calendars
for (i in calendars) {
print(i)
}
for (i in calendars) {
print(i)
}
library(HelpersMG)
install.packages(HelpersMG)
install.packages('HelpersMG')
library(HelpersMG)
wget(calendars)
as.character(calendars)
typeof(calendars)
typeof(calendars[0])
summary(calendars)
calendars
calendars
calendars[1]
calendars[2]
calendars[0]
wget(calendars[1])
wget(as.character(calendars[1])
as.character(calendars[1])
as.character(calendars[1])
as.array(calendars[1])
df<-as.data.frame(calendars)
df
summary(df[0])
summary(df[,0])
df[,0]
wget(df[,0])
wget(df)
for (i in df$V1) {
print(i)
}
wget(df$V1)
cc<-c(df$V1)
cc
df$V1
summary(df)
df<-as.data.frame(calendars[1])
summary(df)
for (i in df$V1) {
wget(i)
}
df$V1[0]
i
substr(i, "20", "/data")
substr(i, "20", "/data")
?substr
?gsub
library(stringr)
str_locate(i, "[0-9]+")
cc<-str_locate(i, "[0-9]+")
cc<-str_locate(i, "20")
cc
cc<-str_locate(i, "/data")
cc
i
cc<-str_locate(i, "data/calendar")
cc
cc<-str_locate(i, "20")
cc
#61
cc<-str_locate(i, "data/calendar")
cc
substr(i, 61, 72)
substr(i, 61, 71)
substr(i, 61, 70)
date<-substr(i, 61, 70)
for (i in df$V1[0]) {
date<-substr(i, 61, 70)
print(date)
}
for (i in df$V1) {
date<-substr(i, 61, 70)
print(date)
}
?attach()
dates<-NULL
for (i in df$V1) {
date<-substr(i, 61, 70)
print(date)
c(dates, date)
}
dates
dates<-NULL
for (i in df$V1) {
date<-substr(i, 61, 70)
print(date)
dates<-c(dates, date)
}
dates
paste('calendar.', date, 'csv.gz')
paste('calendar.', date, 'csv.gz', sep = '')
paste('calendar.', date, '.csv.gz', sep = '')
dates<-as.data.frame()
dates<-as.data.frame
dates
dates<-as.data.frame()
dates<-data.frame()
dates
dates$date<-NULL
dates$file_before<-NULL
dates$file_after<-NULL
cal
cal<-data.frame()
cal$date<-NULL
cal$file_before<-NULL
cal$file_after<-NULL
row_num<-1
cal[row_num, 'date']<-date
for (i in df$V1) {
date<-substr(i, 61, 70)
paste('calendar.', date, '.csv.gz', sep = '')
cal[row_num, 'date']<-date
cal[row_num, 'file_before']<-paste('calendar.', date, '.csv.gz', sep = '')
cal[row_num, 'file_after']<-paste('calendar.', date, '.csv', sep = '')
row_num<-row_num + 1
}
cal
wget(i)
file_before
file_before<-paste('calendar.', date, '.csv.gz', sep = '')
file_before
file.rename('calendar.csv.gz', file_before)
cal<-data.frame()
cal$date<-NULL
cal$file_before<-NULL
cal$file_after<-NULL
row_num<-1
for (i in df$V1) {
date<-substr(i, 61, 70)
file_before<-paste('calendar.', date, '.csv.gz', sep = '')
file_after<-paste('calendar.', date, '.csv', sep = '')
cal[row_num, 'date']<-date
cal[row_num, 'file_before']<-paste('calendar.', date, '.csv.gz', sep = '')
cal[row_num, 'file_after']<-paste('calendar.', date, '.csv', sep = '')
row_num<-row_num + 1
###################################################
wget(i)
file.rename('calendar.csv.gz', file_before)
}
#work
setwd("C://bb//airbnb")
library(dplyr)
df<-cal
for (i in cal)
{
print(i)
}
df<-cal
for (i in cal)
{
print(i[date])
}
df<-cal
for (i in cal)
{
df[i,'date']
}
length(cal)
for (i in range(1:nrow(cal)))
{
df[i,'date']
}
for (i in range(1:nrow(cal)))
{
df[i,'date']
}
df<-cal
df
range(1:nrow(cal))
range(1,nrow(cal))
df<-cal
for (i in 1:nrow(df))
{
df[i,'date']
}
df<-cal
for (i in 1:nrow(df))
{
df[i,'date']
}
nrow(df)
for (i in 1:nrow(df))
{
print(df[i,'date'])
}
df[i,'file_after']
cal<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[i,'file_after'],"calendar.csv",sep = ''))
cal<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[i,'file_after'],"/calendar.csv",sep = ''))
cal
#extract the latest period anbd take the first month
cal<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[1,'file_after'],"/calendar.csv",sep = ''))
df[1,'file_after']
cal.to.save<-cal %>% filter(date > '2020-01-04')
summary(cal)
cal.to.save<-cal %>% filter(date > as.Date('2020-01-04'))
cal
cal$date<-as.Date(cal$date)
cal$date
cal.to.save<-cal %>% filter(date > as.Date('2020-01-04'))
cal.to.save
cal.to.save<-cal %>% filter(date < as.Date('2020-01-04'))
cal.to.save
df
i<-2
to_date<-df[i-1, "date"]
to_date
to_date<-df[i-1, "date"]
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[i,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
df[i,'file_after']
period.to.save<-period %>% filter(date < as.Date(to_date))
period.to.save
cal.to.save <-rbin(cal.to.save, period.to.save)
cal.to.save <-rbind(cal.to.save, period.to.save)
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[1,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
cal.to.save<-period %>% filter(date < as.Date('2020-01-04'))
dim(cal.to.save)
dim(period.to.save)
cal.to.save <-rbind(cal.to.save, period.to.save)
dim(cal.to.save)
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[1,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
cal.to.save<-period %>% filter(date < as.Date('2020-01-04'))
for (i in 2:nrow(df))
{
to_date<-df[i-1, "date"]
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[i,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
period.to.save<-period %>% filter(date < as.Date(to_date))
cal.to.save <-rbind(cal.to.save, period.to.save)
}
i
period.to.save
dim(period.to.save)
dim(period.to.save)
dim(cal.to.save)
head(cal.to.save)
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[1,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
cal.to.save<-period %>% filter(date < as.Date('2020-01-04')) %>% select(listing_id, date, available, price)
for (i in 2:nrow(df))
{
to_date<-df[i-1, "date"]
period<-read.csv(paste("C:/bb/airbnb/data/calendars/", df[i,'file_after'],"/calendar.csv",sep = ''))
period$date<-as.Date(period$date)
period.to.save<-period %>% filter(date < as.Date(to_date)) %>% select(listing_id, date, available, price)
cal.to.save <-rbind(cal.to.save, period.to.save)
}
dim(cal.to.save)
head(cal.to.save)
cal.to.save %>% filter(listing_id == 958)
nn <-cal.to.save %>% filter(listing_id == 958)
summary(nn)
plot (price ~ date, nn)
dim(nn)
1715/365
df
sqlSave(air_conn, cal.to.save)
cal.to.save
sqlSave(air_conn, cal.to.save)
summary (cal.to.save)
cal.to.save$str_date<-as.character.Date(cal.to.save$date)
head(cal.to.save)
cal.to.save$date<-NULL
sqlSave(air_conn, cal.to.save, tablename = 'calendar')
df$date
df
